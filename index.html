<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil del usuario</title>
  <style>
    /* Estilos CSS */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    p {
      margin-bottom: 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Perfil del usuario</h1>
    <p><strong>Dirección de la cuenta:</strong> <span id="address"></span></p>
    <p><strong>Saldo:</strong> <span id="balance"></span> ETH</p>
    <p><strong>NFTs:</strong></p>
    <ul id="nft-list"></ul>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <script>
      // JavaScript
      // Verificar la disponibilidad de Metamask
      if (typeof window.ethereum === 'undefined') {
        alert('Metamask no está instalado. Asegúrate de tenerlo instalado y desbloqueado en tu navegador.');
      } else {
        const addressElement = document.getElementById('address');
        const balanceElement = document.getElementById('balance');
        const nftListElement = document.getElementById('nft-list');

        // Crear una instancia de Web3
        const web3 = new Web3(window.ethereum);

        // Manejar el evento de inicio de sesión
        window.ethereum.request({ method: 'eth_requestAccounts' })
          .then(accounts => {
            const userAddress = accounts[0];
            addressElement.textContent = userAddress;

            // Obtener el saldo de la cuenta
            web3.eth.getBalance(userAddress)
              .then(balance => {
                balanceElement.textContent = web3.utils.fromWei(balance, 'ether');
              })
              .catch(error => {
                console.error('Error al obtener el saldo:', error);
              });

            // Obtener los NFTs del usuario
            const contractAddress = '0x123456789'; // Dirección del contrato del NFT
            const contractABI = [
              // ABI del contrato del NFT
              // Define los métodos y eventos del contrato necesarios para interactuar con él
            ];
            const contract = new web3.eth.Contract(contractABI, contractAddress);

            contract.methods.getNFTs(userAddress).call()
              .then(nfts => {
                // Mostrar los NFTs en la lista
                nfts.forEach(nft => {
                  const li = document.createElement('li');
                  const img = document.createElement('img');
                  img.src = nft.image;
                  img.alt = nft.name;
                  li.appendChild(img);
                  li.appendChild(document.createTextNode(nft.name));
                  nftListElement.appendChild(li);
                });
              })
              .catch(error => {
                console.error('Error al obtener los NFTs:', error);
              });

          })
          .catch(error => {
            console.error('Error al iniciar sesión con Metamask:', error);
          });
      }
    </script>
  </div>
</body>

</html>
